(function(e){var f,g={max:2,flipbook:null,easeFunction:"ease-in-out",duration:500,when:{}},a={init:function(o){var n=this,p=this.data(),m=e.extend({},g,o);if(!m.flipbook||!m.flipbook.turn("is")){throw i("options.flipbook is required")}f="WebKitCSSMatrix" in window||"MozPerspective" in document.body.style;if(typeof(m.max)!="function"){var k=m.max;m.max=function(){return k}}p.zoom={opts:m,axis:j(0,0),scrollPos:j(0,0),eventQueue:[],mouseupEvent:function(){return a._eMouseUp.apply(n,arguments)},eventTouchStart:h(a._eTouchStart,n),eventTouchMove:h(a._eTouchMove,n),eventTouchEnd:h(a._eTouchEnd,n),flipbookEvents:{zooming:h(a._eZoom,n),pressed:h(a._ePressed,n),released:h(a._eReleased,n),start:h(a._eStart,n),turning:h(a._eTurning,n),turned:h(a._eTurned,n),destroying:h(a._eDestroying,n)}};for(var l in m.when){if(Object.prototype.hasOwnProperty.call(m.when,l)){this.bind("zoom."+l,m.when[l])}}for(l in p.zoom.flipbookEvents){if(Object.prototype.hasOwnProperty.call(p.zoom.flipbookEvents,l)){m.flipbook.bind(l,p.zoom.flipbookEvents[l])}}this.css({position:"relative",overflow:"hidden"});if(e.isTouch){m.flipbook.bind("touchstart",p.zoom.eventTouchStart).bind("touchmove",p.zoom.eventTouchMove).bind("touchend",p.zoom.eventTouchEnd);this.bind("touchstart",a._tap)}else{this.mousedown(a._mousedown).click(a._tap)}},_tap:function(m){var l=e(this),n=l.data().zoom,o=n.opts.flipbook;if(n.draggingCorner||n.dragging){return}if(b(e(m.target),l)){a._addEvent.call(l,"tap",m);var k=a._eventSeq.call(l);if(k){l.trigger(k)}}},_addEvent:function(l,m){var n=this.data().zoom,o=(new Date()).getTime(),k={name:l,timestamp:o,event:m};n.eventQueue.push(k);if(n.eventQueue.length>10){n.eventQueue.splice(0,1)}},_eventSeq:function(){var m=this.data().zoom,l=m.eventQueue,k=l.length-1;if(k>0&&l[k].name=="tap"&&l[k-1].name=="tap"&&l[k].event.pageX==l[k-1].event.pageX&&l[k].event.pageY==l[k-1].event.pageY&&l[k].timestamp-l[k-1].timestamp<200&&l[k].timestamp-l[k-1].timestamp>50){return e.extend(l[k].event,{type:"zoom.doubleTap"})}else{if(l[k].name=="tap"){return e.extend(l[k].event,{type:"zoom.tap"})}}},_prepareZoom:function(){var x,n=0,r=this.data().zoom,m=1/this.zoom("value"),t=r.opts.flipbook,o=t.turn("direction"),s=t.data(),l=t.offset(),u=this.offset(),z={height:t.height()},w=t.turn("view");if(t.turn("display")=="double"&&t.data().opts.autoCenter){if(!w[0]){z.width=t.width()/2;n=(o=="ltr")?z.width:0;x=j((o=="ltr")?l.left-u.left+z.width:l.left-u.left,l.top-u.top)}else{if(!w[1]){z.width=t.width()/2;n=(o=="ltr")?0:z.width;x=j((o=="ltr")?l.left-u.left:l.left-u.left+z.width,l.top-u.top)}else{z.width=t.width();x=j(l.left-u.left,l.top-u.top)}}}else{z.width=t.width();x=j(l.left-u.left,l.top-u.top)}if(!r.zoomer){r.zoomer=e("<div />",{"class":"zoomer",css:{overflow:"hidden",position:"absolute",zIndex:"1000000"}}).mousedown(function(){return false}).appendTo(this)}r.zoomer.css({top:x.y,left:x.x,width:z.width,height:z.height});var q=w.join(",");if(q!=r.zoomerView){r.zoomerView=q;r.zoomer.find("*").remove();for(var k=0;k<w.length;k++){if(!w[k]){continue}var v=s.pageObjs[w[k]].offset(),y=e(s.pageObjs[w[k]]);y.clone().transform("").css({width:y.width()*m,height:y.height()*m,position:"absolute",display:"",top:(v.top-l.top)*m,left:(v.left-l.left-n)*m}).appendTo(r.zoomer)}}return{pos:x,size:z}},value:function(){var k=this.data().zoom;return k.opts.flipbook.turn("zoom")},zoomIn:function(C){var u,x=this,F=this.data().zoom,v=F.opts.flipbook,l=F.opts.max(),r=v.offset(),s=this.offset();if(F.zoomIn){return this}v.turn("stop");var D=e.Event("zoom.change");this.trigger(D,[l]);if(D.isDefaultPrevented()){return this}var m=a._prepareZoom.call(this),A=m.pos,E=j(m.size.width/2,m.size.height/2),B=e.cssPrefix(),w=e.cssTransitionEnd(),q=v.data().opts.autoCenter;F.scale=l;v.data().noCenter=true;if(typeof(C)!="undefined"){if("x" in C&&"y" in C){u=j(C.x-A.x,C.y-A.y)}else{u=(e.isTouch)?j(C.originalEvent.touches[0].pageX-A.x-s.left,C.originalEvent.touches[0].pageY-A.y-s.top):j(C.pageX-A.x-s.left,C.pageY-A.y-s.top)}}else{u=j(E.x,E.y)}if(u.x<0||u.y<0||u.x>m.width||u.y>m.height){u.x=E.x;u.y=E.y}var n=j((u.x-E.x)*l+E.x,(u.y-E.y)*l+E.y),z=j((m.size.width*l>this.width())?u.x-n.x:0,(m.size.height*l>this.height())?u.y-n.y:0),t=j(Math.abs(m.size.width*l-this.width()),Math.abs(m.size.height*l-this.height())),p=j(Math.min(0,m.size.width*l-this.width()),Math.min(0,m.size.height*l-this.height())),k=j(E.x*l-E.x-A.x-z.x,E.y*l-E.y-A.y-z.y);if(k.y>t.y){z.y=k.y-t.y+z.y}else{if(k.y<p.y){z.y=k.y-p.y+z.y}}if(k.x>t.x){z.x=k.x-t.x+z.x}else{if(k.x<p.x){z.x=k.x-p.x+z.x}}k=j(E.x*l-E.x-A.x-z.x,E.y*l-E.y-A.y-z.y);var y={};y[B+"transition"]=B+"transform "+F.opts.easeFunction+" "+F.opts.duration+"ms";var o=function(){x.trigger("zoom.zoomIn");F.zoomIn=true;F.flipPosition=j(v.css("left"),v.css("top"));v.turn("zoom",l).css({position:"absolute",margin:"",top:0,left:0});var G=v.offset();F.axis=j(G.left-s.left,G.top-s.top);if(q&&v.turn("display")=="double"){if((v.turn("direction")=="ltr"&&!v.turn("view")[0])||(v.turn("direction")=="rtl"&&!v.turn("view")[1])){F.axis.x=F.axis.x+v.width()/2}}x.zoom("scroll",k);x.bind(e.mouseEvents.down,a._eMouseDown);x.bind(e.mouseEvents.move,a._eMouseMove);e(document).bind(e.mouseEvents.up,F.mouseupEvent);x.bind("mousewheel",a._eMouseWheel);setTimeout(function(){F.zoomer.hide();F.zoomer.remove();F.zoomer=null;F.zoomerView=null},50)};F.zoomer.css(y).show();if(w){F.zoomer.bind(w,function(){e(this).unbind(w);o()})}else{setTimeout(o,F.opts.duration)}F.zoomer.transform(c(z.x,z.y,true)+d(l,true));return this},zoomOut:function(k){var q,w,t=this,B=this.data().zoom,r=B.opts.flipbook,l=1,v=l/B.scale,x=e.cssPrefix(),s=e.cssTransitionEnd(),p=this.offset();k=(typeof(k)!="undefined")?k:B.opts.duration;if(!B.zoomIn){return}var z=e.Event("zoom.change");this.trigger(z,[l]);if(z.isDefaultPrevented()){return this}B.zoomIn=false;B.scale=l;r.data().noCenter=false;t.unbind(e.mouseEvents.down,a._eMouseDown);t.unbind(e.mouseEvents.move,a._eMouseMove);e(document).unbind(e.mouseEvents.up,B.mouseupEvent);t.unbind("mousewheel",a._eMouseWheel);var u={};u[x+"transition"]=x+"transform "+B.opts.easeFunction+" "+k+"ms";r.css(u);var m,A=e("<div />",{css:{position:"relative",top:B.flipPosition.y,left:B.flipPosition.x,width:r.width()*v,height:r.height()*v,background:"blue"}}).appendTo(r.parent());m=j(A.offset().left-p.left,A.offset().top-p.top);A.remove();var o=r.data().opts.autoCenter;if(o&&r.turn("display")=="double"){if(!r.turn("view")[0]){m.x=(r.turn("direction")=="ltr")?m.x-A.width()/4:m.x+A.width()/4}else{if(!r.turn("view")[1]){m.x=(r.turn("direction")=="ltr")?m.x+A.width()/4:m.x-A.width()/4}}}var y=e.findPos(r[0]);w=j(-r.width()/2-y.left+A.width()/2+m.x+p.left,-r.height()/2-y.top+A.height()/2+m.y+p.top);var n=function(){if(r[0].style.removeProperty){r[0].style.removeProperty(x+"transition");r.transform((r.turn("options").acceleration)?c(0,0,true):"").turn("zoom",1);r[0].style.removeProperty("margin");r.css({position:"relative",top:B.flipPosition.y,left:B.flipPosition.x})}else{r.transform("none").turn("zoom",1).css({margin:"",top:B.flipPosition.y,left:B.flipPosition.x,position:"relative"})}if(o){r.turn("center")}t.trigger("zoom.zoomOut")};if(k===0){n()}else{if(s){r.bind(s,function(){e(this).unbind(s);n()});r.transform(c(w.x,w.y,true)+d(v,true))}else{setTimeout(n,k);r.transform(c(w.x,w.y,true)+d(v,true))}}return this},flipbookWidth:function(){var m=this.data().zoom,l=m.opts.flipbook,k=l.turn("view");return(l.turn("display")=="double"&&(!k[0]||!k[1]))?l.width()/2:l.width()},scroll:function(t,p,l){var o=this.data().zoom,q=o.opts.flipbook,u=this.zoom("flipbookWidth"),r=e.cssPrefix();if(f){var s={};if(l){s[r+"transition"]=r+"transform 200ms"}else{s[r+"transition"]="none"}q.css(s);q.transform(c(-o.axis.x-t.x,-o.axis.y-t.y,true))}else{q.css({top:-o.axis.y-t.y,left:-o.axis.x-t.x})}if(!p){var n,m=j(Math.min(0,(u-this.width())/2),Math.min(0,(q.height()-this.height())/2)),k=j((u>this.width())?u-this.width():(u-this.width())/2,(q.height()>this.height())?q.height()-this.height():(q.height()-this.height())/2);if(t.y<m.y){t.y=m.y;n=true}else{if(t.y>k.y){t.y=k.y;n=true}}if(t.x<m.x){t.x=m.x;n=true}else{if(t.x>k.x){t.x=k.x;n=true}}if(n){this.zoom("scroll",t,true,true)}}o.scrollPos=j(t.x,t.y)},resize:function(){var k=this.data().zoom,n=k.opts.flipbook;if(this.zoom("value")>1){var m=n.offset(),l=this.offset();k.axis=j((m.left-l.left)+(k.axis.x+k.scrollPos.x),(m.top-l.top)+(k.axis.y+k.scrollPos.y));if(n.turn("display")=="double"&&n.turn("direction")=="ltr"&&!n.turn("view")[0]){k.axis.x=k.axis.x+n.width()/2}this.zoom("scroll",k.scrollPos)}},_eZoom:function(){var o,l=this.data().zoom,n=l.opts.flipbook,k=n.turn("view");for(var m=0;m<k.length;m++){if(k[m]){this.trigger("zoom.resize",[l.scale,k[m],n.data().pageObjs[k[m]]])}}},_eStart:function(l,k){if(this.zoom("value")!=1){l.preventDefault()}},_eTurning:function(n,q,k){var m=this,l=this.zoom("value"),o=this.data().zoom,s=o.opts.flipbook;o.page=s.turn("page");if(l!=1){for(var r=0;r<k.length;r++){if(k[r]){this.trigger("zoom.resize",[l,k[r],s.data().pageObjs[k[r]]])}}setTimeout(function(){m.zoom("resize")},0)}},_eTurned:function(l,n){if(this.zoom("value")!=1){var k=this,m=this.data().zoom,o=m.opts.flipbook;if(n>m.page){this.zoom("scroll",j(0,m.scrollPos.y),false,true)}else{if(n<m.page){this.zoom("scroll",j(o.width(),m.scrollPos.y),false,true)}}}},_ePressed:function(){var k=e(this).data().zoom;k.draggingCorner=true},_eReleased:function(){var k=e(this).data().zoom;setTimeout(function(){k.draggingCorner=false},1)},_eMouseDown:function(k){var l=e(this).data().zoom;l.draggingCur=(e.isTouch)?j(k.originalEvent.touches[0].pageX,k.originalEvent.touches[0].pageY):j(k.pageX,k.pageY);return false},_eMouseMove:function(l){var m=e(this).data().zoom;if(m.draggingCur){m.dragging=true;var n=(e.isTouch)?j(l.originalEvent.touches[0].pageX,l.originalEvent.touches[0].pageY):j(l.pageX,l.pageY),k=j(n.x-m.draggingCur.x,n.y-m.draggingCur.y);e(this).zoom("scroll",j(m.scrollPos.x-k.x,m.scrollPos.y-k.y),true);m.draggingCur=n;return false}},_eMouseUp:function(k){var l=e(this).data().zoom;if(l.dragging){e(this).zoom("scroll",l.scrollPos)}l.draggingCur=null;setTimeout(function(){l.dragging=false},1)},_eMouseWheel:function(m,p,l,k){var n=e(this).data().zoom,o=j(n.scrollPos.x+l*10,n.scrollPos.y-k*10);e(this).zoom("scroll",o,false,true)},_eTouchStart:function(k,n){var m=e(this).data().zoom,o=m.opts.flipbook,l=j(k.originalEvent.touches[0].pageX,k.originalEvent.touches[0].pageY);m.touch={};m.touch.initial=l;m.touch.last=l;m.touch.timestamp=(new Date()).getTime();m.touch.speed=j(0,0)},_eTouchMove:function(l){var n=e(this).data().zoom,k=e(this).zoom("value"),p=n.opts.flipbook,o=(new Date()).getTime(),m=j(l.originalEvent.touches[0].pageX,l.originalEvent.touches[0].pageY);if(n.touch&&k==1&&!p.data().mouseAction){n.touch.motion=j(m.x-n.touch.last.x,m.y-n.touch.last.y);n.touch.speed.x=(n.touch.speed.x===0)?n.touch.motion.x/(o-n.touch.timestamp):(n.touch.speed.x+(n.touch.motion.x/(o-n.touch.timestamp)))/2;n.touch.last=m;n.touch.timestamp=o}},_eTouchEnd:function(k){var l=e(this).data().zoom;if(l.touch&&e(this).zoom("value")==1){var m=Math.abs(l.touch.initial.y-l.touch.last.y);if(m<50&&(l.touch.speed.x<-1||l.touch.last.x-l.touch.initial.x<-100)){this.trigger("zoom.swipeLeft")}else{if(m<50&&(l.touch.speed.x>1||l.touch.last.x-l.touch.initial.x>100)){this.trigger("zoom.swipeRight")}}}},_eDestroying:function(){var m=this,n=this.data().zoom,o=n.opts.flipbook,l=["tap","doubleTap","resize","zoomIn","zoomOut","swipeLeft","swipeRight"];this.zoom("zoomOut",0);e.each(l,function(q,p){m.unbind("zoom."+p)});for(var k in n.flipbookEvents){if(Object.prototype.hasOwnProperty.call(n.flipbookEvents,k)){o.unbind(k,n.flipbookEvents[k])}}o.unbind("touchstart",n.eventTouchStart).unbind("touchmove",n.eventTouchMove).unbind("touchend",n.eventTouchEnd);this.unbind("touchstart",a._tap).unbind("click",a._tap);n=null;this.data().zoom=null}};function b(k,l){if(k[0]==l[0]){return false}if(k.attr("page")){return true}return(k.parent()[0])?b(k.parent(),l):false}function i(k){function l(m){this.name="TurnJsError";this.message=m}l.prototype=new Error();l.prototype.constructor=l;return new l(k)}function c(k,m,l){return(f&&l)?" translate3d("+k+"px,"+m+"px, 0px) ":" translate("+k+"px, "+m+"px) "}function d(k,l){return(f&&l)?" scale3d("+k+", "+k+", 1) ":" scale("+k+") "}function j(k,l){return{x:k,y:l}}function h(l,k){return function(){return l.apply(k,arguments)}}e.extend(e.fn,{zoom:function(){var k=arguments;if(!k[0]||typeof(k[0])=="object"){return a.init.apply(e(this[0]),k)}else{if(a[k[0]]){return a[k[0]].apply(e(this[0]),Array.prototype.slice.call(k,1))}else{throw i(k[0]+" is not a method")}}}})})(jQuery);