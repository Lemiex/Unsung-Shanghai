(function(r){r.jGestures={};r.jGestures.defaults={};r.jGestures.defaults.thresholdShake={requiredShakes:10,freezeShakes:100,frontback:{sensitivity:10},leftright:{sensitivity:10},updown:{sensitivity:10}};r.jGestures.defaults.thresholdPinchopen=0.05;r.jGestures.defaults.thresholdPinchmove=0.05;r.jGestures.defaults.thresholdPinch=0.05;r.jGestures.defaults.thresholdPinchclose=0.05;r.jGestures.defaults.thresholdRotatecw=5;r.jGestures.defaults.thresholdRotateccw=5;r.jGestures.defaults.thresholdMove=20;r.jGestures.defaults.thresholdSwipe=100;r.jGestures.data={};r.jGestures.data.capableDevicesInUserAgentString=["iPad","iPhone","iPod","Mobile Safari"];r.jGestures.data.hasGestures=(function(){var a;for(a=0;a<r.jGestures.data.capableDevicesInUserAgentString.length;a++){if(navigator.userAgent.indexOf(r.jGestures.data.capableDevicesInUserAgentString[a])!==-1){return true}}return false})();r.hasGestures=r.jGestures.data.hasGestures;r.jGestures.events={touchstart:"jGestures.touchstart",touchendStart:"jGestures.touchend;start",touchendProcessed:"jGestures.touchend;processed",gesturestart:"jGestures.gesturestart",gestureendStart:"jGestures.gestureend;start",gestureendProcessed:"jGestures.gestureend;processed"};jQuery.each({orientationchange_orientationchange01:"orientationchange",gestureend_pinchopen01:"pinchopen",gestureend_pinchclose01:"pinchclose",gestureend_rotatecw01:"rotatecw",gestureend_rotateccw01:"rotateccw",gesturechange_pinch01:"pinch",gesturechange_rotate01:"rotate",touchstart_swipe13:"swipemove",touchstart_swipe01:"swipeone",touchstart_swipe02:"swipetwo",touchstart_swipe03:"swipethree",touchstart_swipe04:"swipefour",touchstart_swipe05:"swipeup",touchstart_swipe06:"swiperightup",touchstart_swipe07:"swiperight",touchstart_swipe08:"swiperightdown",touchstart_swipe09:"swipedown",touchstart_swipe10:"swipeleftdown",touchstart_swipe11:"swipeleft",touchstart_swipe12:"swipeleftup",touchstart_tap01:"tapone",touchstart_tap02:"taptwo",touchstart_tap03:"tapthree",touchstart_tap04:"tapfour",devicemotion_shake01:"shake",devicemotion_shake02:"shakefrontback",devicemotion_shake03:"shakeleftright",devicemotion_shake04:"shakeupdown"},function(a,b){jQuery.event.special[b]={setup:function(){var d=a.split("_");var g=d[0];var c=d[1].slice(0,d[1].length-2);var f=jQuery(this);var e;var h;if(!f.data("ojQueryGestures")||!f.data("ojQueryGestures")[g]){e=f.data("ojQueryGestures")||{};h={};h[g]=true;r.extend(true,e,h);f.data("ojQueryGestures",e);if(r.hasGestures){switch(c){case"orientationchange":f.get(0).addEventListener("orientationchange",t,false);break;case"shake":case"shakefrontback":case"shakeleftright":case"shakeupdown":case"tilt":f.get(0).addEventListener("devicemotion",s,false);break;case"tap":case"swipe":case"swipeup":case"swiperightup":case"swiperight":case"swiperightdown":case"swipedown":case"swipeleftdown":case"swipeleft":f.get(0).addEventListener("touchstart",m,false);break;case"pinchopen":case"pinchclose":case"rotatecw":case"rotateccw":f.get(0).addEventListener("gesturestart",p,false);f.get(0).addEventListener("gestureend",l,false);break;case"pinch":case"rotate":f.get(0).addEventListener("gesturestart",p,false);f.get(0).addEventListener("gesturechange",o,false);break}}else{switch(c){case"tap":case"swipe":f.bind("mousedown",m);break;case"orientationchange":case"pinchopen":case"pinchclose":case"rotatecw":case"rotateccw":case"pinch":case"rotate":case"shake":case"tilt":break}}}return false},add:function(e){var c=jQuery(this);var d=c.data("ojQueryGestures");d[e.type]={originalType:e.type};return false},remove:function(e){var c=jQuery(this);var d=c.data("ojQueryGestures");d[e.type]=false;c.data("ojQueryGestures",d);return false},teardown:function(){var d=a.split("_");var g=d[0];var c=d[1].slice(0,d[1].length-2);var f=jQuery(this);var e;var h;if(!f.data("ojQueryGestures")||!f.data("ojQueryGestures")[g]){e=f.data("ojQueryGestures")||{};h={};h[g]=false;r.extend(true,e,h);f.data("ojQueryGestures",e);if(r.hasGestures){switch(c){case"orientationchange":f.get(0).removeEventListener("orientationchange",t,false);break;case"shake":case"shakefrontback":case"shakeleftright":case"shakeupdown":case"tilt":f.get(0).removeEventListener("devicemotion",s,false);break;case"tap":case"swipe":case"swipeup":case"swiperightup":case"swiperight":case"swiperightdown":case"swipedown":case"swipeleftdown":case"swipeleft":case"swipeleftup":f.get(0).removeEventListener("touchstart",m,false);f.get(0).removeEventListener("touchmove",n,false);f.get(0).removeEventListener("touchend",k,false);break;case"pinchopen":case"pinchclose":case"rotatecw":case"rotateccw":f.get(0).removeEventListener("gesturestart",p,false);f.get(0).removeEventListener("gestureend",l,false);break;case"pinch":case"rotate":f.get(0).removeEventListener("gesturestart",p,false);f.get(0).removeEventListener("gesturechange",o,false);break}}else{switch(c){case"tap":case"swipe":f.unbind("mousedown",m);f.unbind("mousemove",n);f.unbind("mouseup",k);break;case"orientationchange":case"pinchopen":case"pinchclose":case"rotatecw":case"rotateccw":case"pinch":case"rotate":case"shake":case"tilt":break}}}return false}}});function q(c){c.startMove=(c.startMove)?c.startMove:{startX:null,startY:null,timestamp:null};var b=new Date().getTime();var a;var d;if(c.touches){d=[{lastX:c.deltaX,lastY:c.deltaY,moved:null,startX:c.screenX-c.startMove.screenX,startY:c.screenY-c.startMove.screenY}];a={vector:c.vector||null,orientation:window.orientation||null,lastX:((d[0].lastX>0)?+1:((d[0].lastX<0)?-1:0)),lastY:((d[0].lastY>0)?+1:((d[0].lastY<0)?-1:0)),startX:((d[0].startX>0)?+1:((d[0].startX<0)?-1:0)),startY:((d[0].startY>0)?+1:((d[0].startY<0)?-1:0))};d[0].moved=Math.sqrt(Math.pow(Math.abs(d[0].startX),2)+Math.pow(Math.abs(d[0].startY),2))}return{type:c.type||null,originalEvent:c.event||null,delta:d||null,direction:a||{orientation:window.orientation||null,vector:c.vector||null},duration:(c.duration)?c.duration:(c.startMove.timestamp)?b-c.timestamp:null,rotation:c.rotation||null,scale:c.scale||null,description:c.description||[c.type,":",c.touches,":",((d[0].lastX!=0)?((d[0].lastX>0)?"right":"left"):"steady"),":",((d[0].lastY!=0)?((d[0].lastY>0)?"down":"up"):"steady")].join("")}}function t(a){var b=["landscape:clockwise:","portrait:default:","landscape:counterclockwise:","portrait:upsidedown:"];r(window).triggerHandler("orientationchange",{direction:{orientation:window.orientation},description:["orientationchange:",b[((window.orientation/90)+1)],window.orientation].join("")})}function s(a){var h;var i=jQuery(window);var d=i.data("ojQueryGestures");var f=r.jGestures.defaults.thresholdShake;var e=d.oDeviceMotionLastDevicePosition||{accelerationIncludingGravity:{x:0,y:0,z:0},shake:{eventCount:0,intervalsPassed:0,intervalsFreeze:0},shakeleftright:{eventCount:0,intervalsPassed:0,intervalsFreeze:0},shakefrontback:{eventCount:0,intervalsPassed:0,intervalsFreeze:0},shakeupdown:{eventCount:0,intervalsPassed:0,intervalsFreeze:0}};var b={accelerationIncludingGravity:{x:a.accelerationIncludingGravity.x,y:a.accelerationIncludingGravity.y,z:a.accelerationIncludingGravity.z},shake:{eventCount:e.shake.eventCount,intervalsPassed:e.shake.intervalsPassed,intervalsFreeze:e.shake.intervalsFreeze},shakeleftright:{eventCount:e.shakeleftright.eventCount,intervalsPassed:e.shakeleftright.intervalsPassed,intervalsFreeze:e.shakeleftright.intervalsFreeze},shakefrontback:{eventCount:e.shakefrontback.eventCount,intervalsPassed:e.shakefrontback.intervalsPassed,intervalsFreeze:e.shakefrontback.intervalsFreeze},shakeupdown:{eventCount:e.shakeupdown.eventCount,intervalsPassed:e.shakeupdown.intervalsPassed,intervalsFreeze:e.shakeupdown.intervalsFreeze}};var c;var j;var g;for(h in d){switch(h){case"shake":case"shakeleftright":case"shakefrontback":case"shakeupdown":c=[];j=[];c.push(h);if(++b[h].intervalsFreeze>f.freezeShakes&&b[h].intervalsFreeze<(2*f.freezeShakes)){break}b[h].intervalsFreeze=0;b[h].intervalsPassed++;if((h==="shake"||h==="shakeleftright")&&(b.accelerationIncludingGravity.x>f.leftright.sensitivity||b.accelerationIncludingGravity.x<(-1*f.leftright.sensitivity))){c.push("leftright");c.push("x-axis")}if((h==="shake"||h==="shakefrontback")&&(b.accelerationIncludingGravity.y>f.frontback.sensitivity||b.accelerationIncludingGravity.y<(-1*f.frontback.sensitivity))){c.push("frontback");c.push("y-axis")}if((h==="shake"||h==="shakeupdown")&&(b.accelerationIncludingGravity.z+9.81>f.updown.sensitivity||b.accelerationIncludingGravity.z+9.81<(-1*f.updown.sensitivity))){c.push("updown");c.push("z-axis")}if(c.length>1){if(++b[h].eventCount==f.requiredShakes&&(b[h].intervalsPassed)<f.freezeShakes){i.triggerHandler(h,q({type:h,description:c.join(":"),event:a,duration:b[h].intervalsPassed*5}));b[h].eventCount=0;b[h].intervalsPassed=0;b[h].intervalsFreeze=f.freezeShakes+1}else{if(b[h].eventCount==f.requiredShakes&&(b[h].intervalsPassed)>f.freezeShakes){b[h].eventCount=0;b[h].intervalsPassed=0}}}break}g={};g.oDeviceMotionLastDevicePosition=b;i.data("ojQueryGestures",r.extend(true,d,g))}}function m(b){var c=jQuery(b.currentTarget);c.triggerHandler(r.jGestures.events.touchstart,b);if(r.hasGestures){b.currentTarget.addEventListener("touchmove",n,false);b.currentTarget.addEventListener("touchend",k,false)}else{c.bind("mousemove",n);c.bind("mouseup",k)}var e=c.data("ojQueryGestures");var a=(b.touches)?b.touches[0]:b;var d={};d.oLastSwipemove={screenX:a.screenX,screenY:a.screenY,timestamp:new Date().getTime()};d.oStartTouch={screenX:a.screenX,screenY:a.screenY,timestamp:new Date().getTime()};c.data("ojQueryGestures",r.extend(true,e,d))}function n(w){var i=jQuery(w.currentTarget);var x=i.data("ojQueryGestures");var b=!!w.touches;var g=(b)?w.changedTouches[0].screenX:w.screenX;var h=(b)?w.changedTouches[0].screenY:w.screenY;var a=x.oLastSwipemove;var d=g-a.screenX;var e=h-a.screenY;var j;if(!!x.oLastSwipemove){j=q({type:"swipemove",touches:(b)?w.touches.length:"1",screenY:h,screenX:g,deltaY:e,deltaX:d,startMove:a,event:w,timestamp:a.timestamp});i.triggerHandler(j.type,j)}var f={};var c=(w.touches)?w.touches[0]:w;f.oLastSwipemove={screenX:c.screenX,screenY:c.screenY,timestamp:new Date().getTime()};i.data("ojQueryGestures",r.extend(true,x,f))}function k(i){var e=jQuery(i.currentTarget);var c=!!i.changedTouches;var f=(c)?i.changedTouches.length:"1";var E=(c)?i.changedTouches[0].screenX:i.screenX;var F=(c)?i.changedTouches[0].screenY:i.screenY;e.triggerHandler(r.jGestures.events.touchendStart,i);if(r.hasGestures){i.currentTarget.removeEventListener("touchmove",n,false);i.currentTarget.removeEventListener("touchend",k,false)}else{e.unbind("mousemove",n);e.unbind("mouseup",k)}var H=e.data("ojQueryGestures");var b=(Math.abs(H.oStartTouch.screenX-E)>r.jGestures.defaults.thresholdMove||Math.abs(H.oStartTouch.screenY-F)>r.jGestures.defaults.thresholdMove)?true:false;var j=(Math.abs(H.oStartTouch.screenX-E)>r.jGestures.defaults.thresholdSwipe||Math.abs(H.oStartTouch.screenY-F)>r.jGestures.defaults.thresholdSwipe)?true:false;var D;var g;var G;var I;var J;var C;var d=["zero","one","two","three","four"];var h;for(D in H){g=H.oStartTouch;G={};E=(c)?i.changedTouches[0].screenX:i.screenX;F=(c)?i.changedTouches[0].screenY:i.screenY;I=E-g.screenX;J=F-g.screenY;C=q({type:"swipe",touches:f,screenY:F,screenX:E,deltaY:J,deltaX:I,startMove:g,event:i,timestamp:g.timestamp});h=false;switch(D){case"swipeone":if(c===false&&f==1&&b===false){break}if(c===false||(f==1&&b===true&&j===true)){h=true;C.type=["swipe",d[f]].join("");e.triggerHandler(C.type,C)}break;case"swipetwo":if((c&&f==2&&b===true&&j===true)){h=true;C.type=["swipe",d[f]].join("");e.triggerHandler(C.type,C)}break;case"swipethree":if((c&&f==3&&b===true&&j===true)){h=true;C.type=["swipe",d[f]].join("");e.triggerHandler(C.type,C)}break;case"swipefour":if((c&&f==4&&b===true&&j===true)){h=true;C.type=["swipe",d[f]].join("");e.triggerHandler(C.type,C)}break;case"swipeup":case"swiperightup":case"swiperight":case"swiperightdown":case"swipedown":case"swipeleftdown":case"swipeleft":case"swipeleftup":if(c&&b===true&&j===true){h=true;C.type=["swipe",((C.delta[0].lastX!=0)?((C.delta[0].lastX>0)?"right":"left"):""),((C.delta[0].lastY!=0)?((C.delta[0].lastY>0)?"down":"up"):"")].join("");e.triggerHandler(C.type,C)}break;case"tapone":case"taptwo":case"tapthree":case"tapfour":if((b!==true&&h!==true)&&(d[f]==D.slice(3))){C.description=["tap",d[f]].join("");C.type=["tap",d[f]].join("");e.triggerHandler(C.type,C)}break}var a={};e.data("ojQueryGestures",r.extend(true,H,a));e.data("ojQueryGestures",r.extend(true,H,a))}e.triggerHandler(r.jGestures.events.touchendProcessed,i)}function p(b){var c=jQuery(b.currentTarget);c.triggerHandler(r.jGestures.events.gesturestart,b);var a=c.data("ojQueryGestures");var d={};d.oStartTouch={timestamp:new Date().getTime()};c.data("ojQueryGestures",r.extend(true,a,d))}function o(b){var c=jQuery(b.currentTarget);var f,a,d,g;var e=c.data("ojQueryGestures");var h;for(h in e){switch(h){case"pinch":f=b.scale;if(((f<1)&&(f%1)<(1-r.jGestures.defaults.thresholdPinchclose))||((f>1)&&(f%1)>(r.jGestures.defaults.thresholdPinchopen))){a=(f<1)?-1:+1;g=q({type:"pinch",scale:f,touches:null,startMove:e.oStartTouch,event:b,timestamp:e.oStartTouch.timestamp,vector:a,description:["pinch:",a,":",((f<1)?"close":"open")].join("")});c.triggerHandler(g.type,g)}break;case"rotate":f=b.rotation;if(((f<1)&&(-1*(f)>r.jGestures.defaults.thresholdRotateccw))||((f>1)&&(f>r.jGestures.defaults.thresholdRotatecw))){a=(f<1)?-1:+1;g=q({type:"rotate",rotation:f,touches:null,startMove:e.oStartTouch,event:b,timestamp:e.oStartTouch.timestamp,vector:a,description:["rotate:",a,":",((f<1)?"counterclockwise":"clockwise")].join("")});c.triggerHandler(g.type,g)}break}}}function l(b){var c=jQuery(b.currentTarget);c.triggerHandler(r.jGestures.events.gestureendStart,b);var e;var d=c.data("ojQueryGestures");var a;for(a in d){switch(a){case"pinchclose":e=b.scale;if((e<1)&&(e%1)<(1-r.jGestures.defaults.thresholdPinchclose)){c.triggerHandler("pinchclose",q({type:"pinchclose",scale:e,vector:-1,touches:null,startMove:d.oStartTouch,event:b,timestamp:d.oStartTouch.timestamp,description:"pinch:-1:close"}))}break;case"pinchopen":e=b.scale;if((e>1)&&(e%1)>(r.jGestures.defaults.thresholdPinchopen)){c.triggerHandler("pinchopen",q({type:"pinchopen",scale:e,vector:+1,touches:null,startMove:d.oStartTouch,event:b,timestamp:d.oStartTouch.timestamp,description:"pinch:+1:open"}))}break;case"rotatecw":e=b.rotation;if((e>1)&&(e>r.jGestures.defaults.thresholdRotatecw)){c.triggerHandler("rotatecw",q({type:"rotatecw",rotation:e,vector:+1,touches:null,startMove:d.oStartTouch,event:b,timestamp:d.oStartTouch.timestamp,description:"rotate:+1:clockwise"}))}break;case"rotateccw":e=b.rotation;if((e<1)&&(-1*(e)>r.jGestures.defaults.thresholdRotateccw)){c.triggerHandler("rotateccw",q({type:"rotateccw",rotation:e,vector:-1,touches:null,startMove:d.oStartTouch,event:b,timestamp:d.oStartTouch.timestamp,description:"rotate:-1:counterclockwise"}))}break}}c.triggerHandler(r.jGestures.events.gestureendProcessed,b)}})(jQuery);
